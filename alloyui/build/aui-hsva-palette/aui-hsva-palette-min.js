YUI.add("aui-hsva-palette",function(e,t){var n=e.Lang,r=e.Color,i=e.Do,s=e.Widget,o=e.getClassName,u=0,a=255,f=360,l=100,c=100,h=8,p=o("hsv-container-alpha"),d=o("hsv-alpha-canvas"),v=o("hsv-alpha-slider-container"),m=o("hsv-alpha-thumb"),g=o("hsv-alpha-image"),y=/^([a-f0-9]{6}|[a-f0-9]{8}|[a-f0-9]{3})$/i,b=e.Base.create("hsva-palette",e.HSVPalette,[],{TPL_ALPHA_CANVAS:'<span class="'+d+'"></span>',TPL_ALPHA_SLIDER_CONTAINER:'<div class="'+v+'"><div>',TPL_ALPHA_THUMB:'<span class="'+m+'"><span class="'+g+'"></span></span>',initializer:function(){var e=this;e.set("fieldValidator.hex",y),e.after("hsThumbChange",e._afterHsThumbChangeFn,e),e.after("hsvaInputChange",e._afterHSVAInputChange,e),e.after("rgbInputChange",e._afterRGBInputChange,e)},_afterHexInputChange:function(e){var t=this,n=e.hexColor,r=n.substr(6,2),i=parseInt(r,16);t._alphaSlider.set("value",a-i,{src:s.UI_SRC}),t._alphaSliderContainer.setStyle("backgroundColor",n),t._resultView.setStyle("opacity",i/a),t.get("controls")&&t._setFieldValue(t._aContainer,i)},_afterHsThumbChangeFn:function(e){var t=this;t._alphaSliderContainer.setStyle("backgroundColor",e.hexColor)},_afterHSVAInputChange:function(e){var t=this,n=t._getFieldValue(t._aContainer);t._alphaSlider.set("value",a-n,{src:s.UI_SRC}),t._alphaSliderContainer.setStyle("backgroundColor",e.hexColor),t._resultView.setStyle("opacity",n/a)},_afterRGBInputChange:function(e){var t=this;t._alphaSliderContainer.setStyle("backgroundColor",e.hexColor)},_calculateRGBArray:function(e,t,n){var i=this,s;return s=255-i._alphaSlider.get("value"),r.fromArray([e,t,n,s],"RGBA")},_calculateRGBColor:function(e,t,n){var r=this,i=255-r._alphaSlider.get("value");return r._calculateRGBA(e,t,n,i)},_calculateRGBA:function(e,t,i,s){var o="rgb(255, 0, 0, 0)",u,a;if(e!==f||n.toInt(t)!==l||n.toInt(i)!==c)u="hsva("+(e===f?f-1:e)+", "+t+"%, "+i+"%, "+s+")",o=r.toRGBA(u),n.toInt(s)===0&&(a=r.toArray(o),a[3]="0",o=r.fromArray(a,"RGBA"));return o},_convertColor:function(e,t,n){var i=this,s,o;return o=n==="hex",t==="hex"&&(e="#"+e),o?n="Hex":n=(n+"a").toUpperCase(),s=r["to"+n](e),o&&(s=s.substr(1)),s},_getContainerClassName:function(){var t=this,n;return n=e.HSVAPalette.superclass._getContainerClassName.call(t),n+=" "+p,n},_getHexValue:function(e,t){var n,r;return n=parseInt(t[3],10).toString(16),n.length===1&&(n="0"+n),r=e+n,r.substring(1)},_getHSVArray:function(e){var t=this;return r.toArray(e,"HSVA")},_createAlphaSlider:function(){var t=this,n,r,i;r=t.get("contentBox"),i=new e.Slider({axis:"y",min:u,max:a}),i.RAIL_TEMPLATE=t.TPL_ALPHA_CANVAS,i.THUMB_TEMPLATE=t.TPL_ALPHA_THUMB,i.render(t._alphaSliderContainer),n=r.one("."+g).get("offsetHeight"),i.set("length",t._alphaSliderContainer.get("offsetHeight")+n/2),i.on(["slideStart","railMouseDown"],t._setHSContainerXY,t),i.on("valueChange",t._onAlphaChange,t),t._alphaSlider=i},_createSliders:function(){var t=this;e.HSVAPalette.superclass._createSliders.call(t),t._createAlphaSlider()},_getHexContainerConfig:function(){var e=this;return{label:e.get("strings").hex,maxlength:h,suffix:"-hex",type:"hex",unit:"",value:"ff0000ff"}},_normalizeHexValue:function(e){var t="";return e.length===3?t="fffff":e.length===6&&(t="ff"),e+=t},_onAlphaChange:function(e){var t=this,n,i,o,u,f,l,h,p,d,v;e.src!==s.UI_SRC&&(n=e.newVal,t._resultView.setStyle("opacity",1-n/a),i=t._colorThumb.getXY(),o=i[0]-t._hsContainerXY[0]+t._colorThumbGutter,u=i[1]-t._hsContainerXY[1]+t._colorThumbGutter,f=t._calculateHue(o),l=t._calculateSaturation(u),h=c-t._valueSlider.get("value"),p=t._calculateRGBA(f,l,h,a-n),d=r.toArray(p),v=t._getHexValue(r.toHex(p),d),t._setFieldValue(t._outputContainer,v),t.get("controls")&&(t._setFieldValue(t._aContainer,a-n),t._setFieldValue(t._rContainer,d[0]),t._setFieldValue(t._gContainer,d[1]),t._setFieldValue(t._bContainer,d[2])))},_renderAlphaSliderContainer:function(){var e=this;e._alphaSliderContainer=e._viewContainer.appendChild(e.TPL_ALPHA_SLIDER_CONTAINER)},_renderFields:function(){var t=this;e.HSVAPalette.superclass._renderFields.call(t),t._aContainer=t._renderField(t._labelValueHSVContainer,{label:t.get("strings").a,maxlength:3,suffix:"-a",type:"alpha",unit:"",value:a})},_renderViewContainerContent:function(){var t=this;e.HSVAPalette.superclass._renderViewContainerContent.call(t),t._renderAlphaSliderContainer()}},{NAME:"hsva-palette",NS:"hsva-palette"});e.HSVAPalette=b},"2.5.0",{requires:["aui-hsv-palette"],skinnable:!0});
